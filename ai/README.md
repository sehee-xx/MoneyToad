# ğŸš€ AI Fintech System - ì§€ëŠ¥í˜• ê¸ˆìœµ ë°ì´í„° ë¶„ì„ í”Œë«í¼

## ğŸ“Œ í”„ë¡œì íŠ¸ ê°œìš”

**AI ê¸°ë°˜ ê¸ˆìœµ ê±°ë˜ ë¶„ì„ ë° ì˜ˆì¸¡ ì‹œìŠ¤í…œ**ìœ¼ë¡œ, ì‚¬ìš©ìì˜ ê±°ë˜ ë‚´ì—­ì„ ìë™ìœ¼ë¡œ ë¶„ë¥˜í•˜ê³  ë¯¸ë˜ ì§€ì¶œì„ ì˜ˆì¸¡í•˜ëŠ” ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì•„í‚¤í…ì²˜ ê¸°ë°˜ í”Œë«í¼ì…ë‹ˆë‹¤.

### í•µì‹¬ ê°€ì¹˜
- ğŸ¯ **ì •í™•í•œ ê±°ë˜ ë¶„ë¥˜**: AI ê¸°ë°˜ ìë™ ì¹´í…Œê³ ë¦¬ ë¶„ë¥˜ (13ê°œ ì¹´í…Œê³ ë¦¬)
- ğŸ“Š **ì§€ì¶œ ì˜ˆì¸¡**: Facebook Prophetì„ í™œìš©í•œ ì‹œê³„ì—´ ì˜ˆì¸¡
- ğŸ“ˆ **ë² ì´ìŠ¤ë¼ì¸ ë¶„ì„**: ê³¼ê±° 11ê°œì›” ì†Œë¹„ ê¸°ì¤€ ê¸ˆì•¡ ì œê³µ
- âš¡ **ì‹¤ì‹œê°„ ì²˜ë¦¬**: ë¹„ë™ê¸° ëŒ€ìš©ëŸ‰ ë°ì´í„° ì²˜ë¦¬
- ğŸ”„ **í™•ì¥ ê°€ëŠ¥**: ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì•„í‚¤í…ì²˜

## ğŸ— ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Client Applications                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼ Port 8000
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚     API Gateway         â”‚
              â”‚   (í†µí•© ì§„ì…ì /ë¼ìš°íŒ…)    â”‚
              â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚    â”‚    â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚                 â”‚                 â”‚
      â–¼                 â–¼                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Classifierâ”‚      â”‚ Analysis â”‚      â”‚   CSV    â”‚
â”‚ Service  â”‚      â”‚ Service  â”‚      â”‚ Manager  â”‚
â”‚          â”‚      â”‚          â”‚      â”‚ Service  â”‚
â”‚  (GPT)   â”‚      â”‚(Prophet) â”‚      â”‚          â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚                 â”‚                 â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚               â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
        â”‚   MinIO/S3  â”‚ â”‚    Redis    â”‚
        â”‚  (Storage)  â”‚ â”‚   (Cache)   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
        â”‚ Azure MySQL â”‚
        â”‚  (Database) â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“¦ ì„œë¹„ìŠ¤ êµ¬ì„±

### 1. **API Gateway** (Port: 8000)
- í†µí•© API ì§„ì…ì 
- ìš”ì²­ ë¼ìš°íŒ… ë° í”„ë¡ì‹œ
- Swagger UI í†µí•© ì œê³µ
- ì„œë¹„ìŠ¤ í—¬ìŠ¤ ì²´í¬

### 2. **Classifier Service** (Port: 8001 - ë‚´ë¶€)
- OpenAI GPT ê¸°ë°˜ ê±°ë˜ ë¶„ë¥˜
- 13ê°œ ì§€ì¶œ ì¹´í…Œê³ ë¦¬ ìë™ ë¶„ë¥˜
- ë°°ì¹˜ ì²˜ë¦¬ ìµœì í™”
- ì •í™•ë„ 95% ì´ìƒ

### 3. **Analysis Service** (Port: 8002 - ë‚´ë¶€)
- Facebook Prophet ì‹œê³„ì—´ ì˜ˆì¸¡
- ì¹´í…Œê³ ë¦¬ë³„ í˜„ì¬ì›” ì§€ì¶œ ì˜ˆì¸¡
- ê³¼ê±° 11ê°œì›” ë² ì´ìŠ¤ë¼ì¸ ê³„ì‚°
- ëˆ„ìˆ˜(ì´ˆê³¼ ì§€ì¶œ) ë¶„ì„

### 4. **CSV Manager Service** (Port: 8003 - ë‚´ë¶€)
- CSV íŒŒì¼ ì—…ë¡œë“œ/ê´€ë¦¬
- ì¤‘ë³µ íŒŒì¼ëª… í—ˆìš© (ê³ ìœ  file_id ê´€ë¦¬)
- MinIO/S3 í†µí•©
- Redis ê¸°ë°˜ ë©”íƒ€ë°ì´í„° ê´€ë¦¬

## ğŸš¦ ìƒíƒœ ê´€ë¦¬ ì‹œìŠ¤í…œ

### 3-State ì‹œìŠ¤í…œ (ê°„ì†Œí™”ë¨)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”
â”‚ uploadingâ”‚â”€â”€â”€â”€â–¶â”‚ analyzing  â”‚â”€â”€â”€â”€â–¶â”‚ none â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”˜
```

| ìƒíƒœ | ì„¤ëª… | ë‹¤ìŒ ê°€ëŠ¥ ìƒíƒœ |
|------|------|--------------|
| `none` | ìœ íœ´ ìƒíƒœ (ì´ˆê¸°/ì™„ë£Œ) | `uploading`, `analyzing` |
| `uploading` | íŒŒì¼ ì—…ë¡œë“œ ì¤‘ | `none` |
| `analyzing` | AI ë¶„ì„ ì¤‘ | `none` |

## ğŸ¯ ì£¼ìš” API ì—”ë“œí¬ì¸íŠ¸

### 1. CSV íŒŒì¼ ê´€ë¦¬
```bash
# íŒŒì¼ ì—…ë¡œë“œ (ì¤‘ë³µ íŒŒì¼ëª… í—ˆìš©)
POST /api/ai/csv/upload
Content-Type: multipart/form-data
file: transactions.csv

# ìƒíƒœ í™•ì¸
GET /api/ai/csv/status?file_id={file_id}

# íŒŒì¼ ì‚­ì œ
DELETE /api/ai/csv/delete?file_id={file_id}

# íŒŒì¼ êµì²´
PUT /api/ai/csv/change?file_id={file_id}
```

### 2. ê±°ë˜ ë¶„ë¥˜
```bash
# ë‹¨ì¼ ê±°ë˜ ë¶„ë¥˜
GET /api/ai/classify?merchant=ìŠ¤íƒ€ë²…ìŠ¤&amount=4800

# ë°°ì¹˜ ë¶„ë¥˜ ì‹œì‘
POST /api/ai/classify/process?file_id={file_id}

# ë¶„ë¥˜ ê²°ê³¼ ì¡°íšŒ
GET /api/ai/classify/result?file_id={file_id}
```

### 3. ì§€ì¶œ ë¶„ì„ ë° ì˜ˆì¸¡
```bash
# ë¶„ì„ ì‹œì‘ (í˜„ì¬ì›” + 11ê°œì›” ë² ì´ìŠ¤ë¼ì¸)
POST /api/ai/data?file_id={file_id}

# í˜„ì¬ì›” ì˜ˆì¸¡ ë° ëˆ„ìˆ˜ ì¡°íšŒ
GET /api/ai/data/leak?file_id={file_id}&year=2024&month=12

# ê³¼ê±° 11ê°œì›” ë² ì´ìŠ¤ë¼ì¸ ì¡°íšŒ
GET /api/ai/data/baseline?file_id={file_id}
```

## ğŸ“Š ë² ì´ìŠ¤ë¼ì¸ ì˜ˆì¸¡ ì‹œìŠ¤í…œ

### ê°œë…
**ì†Œë¹„ ê¸°ì¤€ ê¸ˆì•¡**: í˜„ì¬ì›” ê¸°ì¤€ ê³¼ê±° 11ê°œì›” ê°ê°ì— ëŒ€í•´, í•´ë‹¹ ì›” ì´ì „ ë°ì´í„°ë§Œ ì‚¬ìš©í•˜ì—¬ ê³„ì‚°í•œ ì˜ˆìƒ ì§€ì¶œì•¡

### êµ¬í˜„ ë°©ì‹
```python
# ì˜ˆ: í˜„ì¬ 12ì›”ì¸ ê²½ìš°
1ì›” ë² ì´ìŠ¤ë¼ì¸: ì „ë…„ 12ì›”ê¹Œì§€ ë°ì´í„°ë¡œ 1ì›” ì˜ˆì¸¡
2ì›” ë² ì´ìŠ¤ë¼ì¸: 1ì›”ê¹Œì§€ ë°ì´í„°ë¡œ 2ì›” ì˜ˆì¸¡
...
11ì›” ë² ì´ìŠ¤ë¼ì¸: 10ì›”ê¹Œì§€ ë°ì´í„°ë¡œ 11ì›” ì˜ˆì¸¡
12ì›” í˜„ì¬ ì˜ˆì¸¡: 11ì›”ê¹Œì§€ ì „ì²´ ë°ì´í„°ë¡œ 12ì›” ì˜ˆì¸¡
```

### ë¶„ì„ í”„ë¡œì„¸ìŠ¤ (ìˆœì°¨ ì‹¤í–‰)
1. **í˜„ì¬ì›” ì˜ˆì¸¡ ìš°ì„  ê³„ì‚° ë° ì €ì¥**
2. **ê³¼ê±° 11ê°œì›” ë² ì´ìŠ¤ë¼ì¸ ê³„ì‚°**

### API ì‘ë‹µ ì˜ˆì‹œ
```json
{
  "file_id": "abc-123-def-456",
  "baseline_months": [
    {
      "year": 2024,
      "month": 11,
      "total_predicted": 1100431.42,
      "categories_count": 13,
      "category_predictions": {
        "ì‹ë¹„": {
          "predicted_amount": 450000,
          "lower_bound": 420000,
          "upper_bound": 480000
        }
      },
      "training_data_until": "2024-10-31"
    }
  ],
  "months_count": 11
}
```

## ğŸ“ˆ ì§€ì› ì¹´í…Œê³ ë¦¬ (13ê°œ)

| ì¹´í…Œê³ ë¦¬ | ì„¤ëª… | ì˜ˆì¸¡ ëª¨ë¸ íŠ¹ì„± |
|---------|------|--------------|
| ì‹ë¹„ | ì¼ë°˜ ì‹ì‚¬ | ì£¼ê°„ ê³„ì ˆì„± ê°•í•¨ |
| êµí†µ/ì°¨ëŸ‰ | ëŒ€ì¤‘êµí†µ, ì£¼ìœ  | ì›”ê°„ íŒ¨í„´ |
| ë§ˆíŠ¸/í¸ì˜ì  | ìƒí•„í’ˆ êµ¬ë§¤ | ì£¼ê°„ íŒ¨í„´ |
| ì˜¨ë¼ì¸ì‡¼í•‘ | ì´ì»¤ë¨¸ìŠ¤ | ì´ë²¤íŠ¸ ê¸°ë°˜ |
| ì¹´í˜/ê°„ì‹ | ì¹´í˜, ë””ì €íŠ¸ | ì£¼ê°„ ê³„ì ˆì„± |
| ì˜ë£Œ/ê±´ê°• | ë³‘ì›, ì•½êµ­ | ë¹„ì •ê¸°ì  |
| ë¬¸í™”/ì—¬ê°€ | ì˜í™”, ê³µì—° | ì£¼ë§ ì§‘ì¤‘ |
| ìƒí™œ | ê³µê³¼ê¸ˆ, í†µì‹  | ì›”ê°„ ê³ ì • |
| ë·°í‹°/ë¯¸ìš© | í™”ì¥í’ˆ, ë¯¸ìš©ì‹¤ | ì›”ê°„ íŒ¨í„´ |
| ì—¬í–‰/ìˆ™ë°• | í˜¸í…”, í•­ê³µ | ê³„ì ˆì„± |
| êµìœ¡ | í•™ì›, ê°•ì˜ | ë¶„ê¸°ë³„ |
| ìˆ /ìœ í¥ | ì£¼ì , í´ëŸ½ | ì£¼ë§ ì§‘ì¤‘ |
| ê¸°íƒ€ | ë¯¸ë¶„ë¥˜ | ëœë¤ |

## ğŸš€ Quick Start

### Prerequisites
- Docker & Docker Compose
- Python 3.11+
- 8GB+ RAM
- OpenAI API Key (í•„ìˆ˜)

### 1. í™˜ê²½ ì„¤ì •
```bash
# .env íŒŒì¼ ìƒì„±
cp .env.example .env

# .env íŒŒì¼ ìˆ˜ì • (OpenAI API Key í•„ìˆ˜)
OPENAI_API_KEY=sk-your-api-key-here
```

### 2. ì‹œìŠ¤í…œ ì‹œì‘
```bash
# ì „ì²´ ì„œë¹„ìŠ¤ ì‹œì‘
docker-compose up -d

# ë˜ëŠ” Makefile ì‚¬ìš©
make up

# ìƒíƒœ í™•ì¸
docker-compose ps

# ë¡œê·¸ í™•ì¸
docker-compose logs -f
```

### 3. API ì ‘ì†
- **Swagger UI**: http://localhost:8000/api/ai/docs
- **ReDoc**: http://localhost:8000/api/ai/redoc
- **Health Check**: http://localhost:8000/api/ai/health

## ğŸ“ API ì‚¬ìš© ì˜ˆì‹œ

### ì „ì²´ ì›Œí¬í”Œë¡œìš°
```bash
# 1. CSV íŒŒì¼ ì—…ë¡œë“œ
curl -X POST "http://localhost:8000/api/ai/csv/upload" \
  -H "X-Admin-Token: admin-token" \
  -F "file=@transactions.csv"

# Response: {"file_id": "abc-123", "status": "uploading"}

# 2. ê±°ë˜ ë¶„ë¥˜ ì‹¤í–‰
curl -X POST "http://localhost:8000/api/ai/classify/process?file_id=abc-123" \
  -H "X-Admin-Token: admin-token"

# 3. ìƒíƒœ í™•ì¸ (ë¶„ë¥˜ ì™„ë£Œ ëŒ€ê¸°)
curl "http://localhost:8000/api/ai/csv/status?file_id=abc-123" \
  -H "X-User-Token: user-token"

# 4. ì˜ˆì¸¡ ë¶„ì„ ì‹œì‘
curl -X POST "http://localhost:8000/api/ai/data?file_id=abc-123"

# 5. í˜„ì¬ì›” ì˜ˆì¸¡ ê²°ê³¼ ì¡°íšŒ
curl "http://localhost:8000/api/ai/data/leak?file_id=abc-123"

# 6. ê³¼ê±° 11ê°œì›” ë² ì´ìŠ¤ë¼ì¸ ì¡°íšŒ
curl "http://localhost:8000/api/ai/data/baseline?file_id=abc-123"
```

### Python ì˜ˆì œ
```python
import requests
from datetime import datetime

BASE_URL = "http://localhost:8000/api/ai"
headers = {"X-Admin-Token": "admin-token"}

# 1. CSV íŒŒì¼ ì—…ë¡œë“œ
with open('transactions.csv', 'rb') as f:
    response = requests.post(
        f"{BASE_URL}/csv/upload",
        files={'file': f},
        headers=headers
    )
    file_id = response.json()['file_id']
    print(f"File uploaded: {file_id}")

# 2. ë°°ì¹˜ ë¶„ë¥˜ ì‹œì‘
response = requests.post(
    f"{BASE_URL}/classify/process?file_id={file_id}",
    headers=headers
)
print("Classification started")

# 3. ë¶„ì„ ì‹œì‘
response = requests.post(
    f"{BASE_URL}/data?file_id={file_id}"
)
print("Analysis started")

# 4. í˜„ì¬ì›” ì˜ˆì¸¡ ê²°ê³¼ ì¡°íšŒ
response = requests.get(
    f"{BASE_URL}/data/leak?file_id={file_id}"
)
predictions = response.json()
print(f"Current month predictions: {predictions}")

# 5. ë² ì´ìŠ¤ë¼ì¸ ì¡°íšŒ
response = requests.get(
    f"{BASE_URL}/data/baseline?file_id={file_id}"
)
baseline = response.json()
print(f"Baseline for {baseline['months_count']} months")
```

## ğŸ—„ ë°ì´í„°ë² ì´ìŠ¤ ERD

### Entity Relationship Diagram

```mermaid
erDiagram
    PREDICTIONS ||--o{ ANALYSIS_JOBS : "belongs to"
    BASELINE_PREDICTIONS ||--o{ ANALYSIS_JOBS : "belongs to"
    LEAK_ANALYSIS ||--o{ ANALYSIS_JOBS : "belongs to"
    DOOJO_ANALYSIS ||--o{ ANALYSIS_JOBS : "belongs to"

    PREDICTIONS {
        int id PK
        string file_id FK
        string category
        date prediction_date
        float predicted_amount
        float lower_bound
        float upper_bound
        datetime created_at
        datetime updated_at
    }

    BASELINE_PREDICTIONS {
        int id PK
        string file_id FK
        string category
        int year
        int month
        float predicted_amount
        float lower_bound
        float upper_bound
        date training_cutoff_date
        datetime created_at
    }

    LEAK_ANALYSIS {
        int id PK
        string file_id FK
        int year
        int month
        float actual_amount
        float predicted_amount
        float leak_amount
        json analysis_data
        datetime created_at
    }

    DOOJO_ANALYSIS {
        int id PK
        string file_id FK
        string category
        int year
        int month
        float min_amount
        float max_amount
        float current_threshold
        float real_amount
        string result
        datetime created_at
        datetime updated_at
    }

    ANALYSIS_JOBS {
        int id PK
        string job_id UK
        string file_id FK
        string status
        string error_message
        datetime created_at
        datetime completed_at
        json job_metadata
    }
```

### í…Œì´ë¸” ìƒì„¸ ì„¤ëª…

#### 1. **predictions** - í˜„ì¬ì›” ì˜ˆì¸¡ ë°ì´í„°
```sql
CREATE TABLE predictions (
    id INT AUTO_INCREMENT PRIMARY KEY,
    file_id VARCHAR(255) NOT NULL,          -- CSV íŒŒì¼ ì‹ë³„ì
    category VARCHAR(100) NOT NULL,          -- ì¹´í…Œê³ ë¦¬ëª…
    prediction_date DATE NOT NULL,           -- ì˜ˆì¸¡ ë‚ ì§œ (YYYY-MM-01)
    predicted_amount FLOAT,                  -- ì˜ˆì¸¡ ê¸ˆì•¡
    lower_bound FLOAT,                       -- ì‹ ë¢°êµ¬ê°„ í•˜í•œ
    upper_bound FLOAT,                       -- ì‹ ë¢°êµ¬ê°„ ìƒí•œ
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    UNIQUE KEY uq_file_cat_date (file_id, category, prediction_date),
    INDEX idx_file_id (file_id)
);
```

#### 2. **baseline_predictions** - ê³¼ê±° 11ê°œì›” ê¸°ì¤€ì„  ì˜ˆì¸¡
```sql
CREATE TABLE baseline_predictions (
    id INT AUTO_INCREMENT PRIMARY KEY,
    file_id VARCHAR(255) NOT NULL,          -- CSV íŒŒì¼ ì‹ë³„ì
    category VARCHAR(100) NOT NULL,          -- ì¹´í…Œê³ ë¦¬ëª…
    year INT NOT NULL,                      -- ì˜ˆì¸¡ ì—°ë„
    month INT NOT NULL,                     -- ì˜ˆì¸¡ ì›”
    predicted_amount FLOAT,                  -- ì˜ˆì¸¡ ê¸ˆì•¡
    lower_bound FLOAT,                       -- ì‹ ë¢°êµ¬ê°„ í•˜í•œ
    upper_bound FLOAT,                       -- ì‹ ë¢°êµ¬ê°„ ìƒí•œ
    training_cutoff_date DATE,              -- í•™ìŠµ ë°ì´í„° ë§ˆê°ì¼
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    UNIQUE KEY uq_baseline_file_cat_year_month (file_id, category, year, month),
    INDEX idx_file_year_month (file_id, year, month)
);
```

#### 3. **leak_analysis** - ëˆ„ìˆ˜(ì´ˆê³¼ì§€ì¶œ) ë¶„ì„
```sql
CREATE TABLE leak_analysis (
    id INT AUTO_INCREMENT PRIMARY KEY,
    file_id VARCHAR(255) NOT NULL,          -- CSV íŒŒì¼ ì‹ë³„ì
    year INT NOT NULL,                      -- ë¶„ì„ ì—°ë„
    month INT NOT NULL,                     -- ë¶„ì„ ì›”
    actual_amount FLOAT,                    -- ì‹¤ì œ ì§€ì¶œì•¡
    predicted_amount FLOAT,                  -- ì˜ˆì¸¡ ì§€ì¶œì•¡
    leak_amount FLOAT,                      -- ëˆ„ìˆ˜ ê¸ˆì•¡ (ì‹¤ì œ - ì˜ˆì¸¡)
    analysis_data JSON,                     -- ìƒì„¸ ë¶„ì„ ë°ì´í„°
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    UNIQUE KEY uq_file_year_month (file_id, year, month),
    INDEX idx_file_id (file_id)
);
```

#### 4. **doojo_analysis** - ë‘êº¼ë¹„ ì¡°ì–¸(ì¹´í…Œê³ ë¦¬ë³„ ì§€ì¶œ ë‹¬ì„±) ë¶„ì„
```sql
CREATE TABLE doojo_analysis (
    id INT AUTO_INCREMENT PRIMARY KEY,
    file_id VARCHAR(255) NOT NULL,          -- CSV íŒŒì¼ ì‹ë³„ì
    category VARCHAR(100) NOT NULL,          -- ì¹´í…Œê³ ë¦¬ëª…
    year INT NOT NULL,                      -- ë¶„ì„ ì—°ë„
    month INT NOT NULL,                     -- ë¶„ì„ ì›”
    min_amount FLOAT NOT NULL,              -- 12ê°œì›” ìµœì†Œ ì§€ì¶œ
    max_amount FLOAT NOT NULL,              -- 12ê°œì›” ìµœëŒ€ ì§€ì¶œ
    current_threshold FLOAT NOT NULL,       -- í˜„ì¬ì›” ëˆ„ìˆ˜ ê¸°ì¤€
    real_amount FLOAT,                      -- ì‹¤ì œ ì‚¬ìš© ê¸ˆì•¡
    result VARCHAR(10),                     -- 'true'(ëˆ„ìˆ˜) / 'false'(ì •ìƒ)
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    UNIQUE KEY uq_doojo_file_cat_year_month (file_id, category, year, month),
    INDEX idx_file_category (file_id, category)
);
```

#### 5. **analysis_jobs** - ë¹„ë™ê¸° ë¶„ì„ ì‘ì—… ì¶”ì 
```sql
CREATE TABLE analysis_jobs (
    id INT AUTO_INCREMENT PRIMARY KEY,
    job_id VARCHAR(255) UNIQUE NOT NULL,    -- ì‘ì—… ê³ ìœ  ID
    file_id VARCHAR(255) NOT NULL,          -- CSV íŒŒì¼ ì‹ë³„ì
    status VARCHAR(50) NOT NULL DEFAULT 'pending', -- pending/completed/failed
    error_message VARCHAR(1000),            -- ì˜¤ë¥˜ ë©”ì‹œì§€
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    completed_at TIMESTAMP NULL,            -- ì™„ë£Œ ì‹œê°„
    job_metadata JSON,                      -- ì‘ì—… ë©”íƒ€ë°ì´í„°
    INDEX idx_job_id (job_id),
    INDEX idx_file_id (file_id),
    INDEX idx_status (status)
);
```

### ë°ì´í„° íë¦„

1. **CSV ì—…ë¡œë“œ** â†’ file_id ìƒì„±
2. **ë¶„ì„ ì‹œì‘** â†’ analysis_jobs ë ˆì½”ë“œ ìƒì„±
3. **Prophet ë¶„ì„ ì‹¤í–‰**:
   - predictions í…Œì´ë¸”ì— í˜„ì¬ì›” ì˜ˆì¸¡ ì €ì¥
   - doojo_analysis í…Œì´ë¸”ì— ë‘êº¼ë¹„ ì¡°ì–¸ ë°ì´í„° ì €ì¥
   - leak_analysis í…Œì´ë¸”ì— ëˆ„ìˆ˜ ë¶„ì„ ì €ì¥
4. **Baseline ê³„ì‚°** â†’ baseline_predictionsì— 11ê°œì›” ë°ì´í„° ì €ì¥
5. **ë¶„ì„ ì™„ë£Œ** â†’ analysis_jobs ìƒíƒœ ì—…ë°ì´íŠ¸

### ì¸ë±ìŠ¤ ì „ëµ

- **file_id**: ëª¨ë“  í…Œì´ë¸”ì˜ ì£¼ìš” ê²€ìƒ‰ í‚¤
- **category**: ì¹´í…Œê³ ë¦¬ë³„ ì§‘ê³„ ì¿¼ë¦¬ ìµœì í™”
- **year, month**: ì‹œê³„ì—´ ë°ì´í„° ì¡°íšŒ ìµœì í™”
- **Unique Constraints**: ì¤‘ë³µ ë°ì´í„° ë°©ì§€

## ğŸ“Š ëª¨ë‹ˆí„°ë§ & ë¡œê¹…

### í—¬ìŠ¤ì²´í¬ ì—”ë“œí¬ì¸íŠ¸
```bash
# Gateway ì¢…í•© í—¬ìŠ¤
GET /api/ai/health

# ì„œë¹„ìŠ¤ë³„ ìƒíƒœ
GET /api/ai/services
```

### ë¡œê·¸ í™•ì¸
```bash
# ì „ì²´ ë¡œê·¸
docker-compose logs

# íŠ¹ì • ì„œë¹„ìŠ¤ ë¡œê·¸
docker-compose logs analysis -f

# Makefile ì‚¬ìš©
make logs
```

## ğŸ”§ íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### Redis ì—°ê²° ë¬¸ì œ
```bash
docker-compose restart redis
docker exec redis-cache redis-cli ping
```

### Azure MySQL ì—°ê²° ë¬¸ì œ
```bash
# Analysis ì„œë¹„ìŠ¤ ì¬ì‹œì‘
docker-compose restart analysis

# SSL ì—°ê²° í™•ì¸
docker-compose logs analysis --tail 50
```

### MinIO ì—…ë¡œë“œ ë¬¸ì œ
```bash
# MinIO ì½˜ì†” ì ‘ì†
http://localhost:9001
# ID: minioadmin / PW: minioadmin
```

### ì „ì²´ ì‹œìŠ¤í…œ ì¬ì‹œì‘
```bash
make down
make clean
make up
```

## ğŸ“ˆ ì„±ëŠ¥ ìµœì í™”

### 1. ë³‘ë ¬ ì²˜ë¦¬
- ThreadPoolExecutor (4 workers)
- ì¹´í…Œê³ ë¦¬ë³„ ë…ë¦½ ëª¨ë¸ í•™ìŠµ
- í˜„ì¬ì›” ìš°ì„  ì²˜ë¦¬ í›„ ë² ì´ìŠ¤ë¼ì¸ ê³„ì‚°

### 2. ìºì‹± ì „ëµ
- Redis ê¸°ë°˜ ë©”íƒ€ë°ì´í„° ìºì‹±
- file_idë¥¼ primary keyë¡œ ì‚¬ìš©
- ìƒíƒœ ì •ë³´ ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸

### 3. ë°ì´í„°ë² ì´ìŠ¤ ìµœì í™”
- ì ì ˆí•œ ì¸ë±ì‹±
- ë°°ì¹˜ ì‚½ì…/ì—…ë°ì´íŠ¸
- ì»¤ë„¥ì…˜ í’€ë§

## ğŸ”’ ë³´ì•ˆ

### ì¸ì¦ ì‹œìŠ¤í…œ
- Admin Token: ê´€ë¦¬ ê¸°ëŠ¥ (ì—…ë¡œë“œ, ì‚­ì œ, ë¶„ë¥˜)
- User Token: ì¡°íšŒ ê¸°ëŠ¥
- í™˜ê²½ ë³€ìˆ˜ë¡œ í† í° ê´€ë¦¬

### API Key ë³´ì•ˆ
- OpenAI API Key í™˜ê²½ ë³€ìˆ˜ ê´€ë¦¬
- .env íŒŒì¼ git ignore
- Docker secrets ê¶Œì¥

### ë„¤íŠ¸ì›Œí¬ ë³´ì•ˆ
- ë‚´ë¶€ ì„œë¹„ìŠ¤ ê²©ë¦¬
- Gatewayë§Œ ì™¸ë¶€ ë…¸ì¶œ
- ì„œë¹„ìŠ¤ê°„ ë‚´ë¶€ í†µì‹ 

## ğŸ“š ê¸°ìˆ  ìŠ¤íƒ

### Backend
- **FastAPI**: ë¹„ë™ê¸° ì›¹ í”„ë ˆì„ì›Œí¬
- **Prophet**: Facebook ì‹œê³„ì—´ ì˜ˆì¸¡
- **OpenAI GPT-4**: ê±°ë˜ ë¶„ë¥˜
- **SQLAlchemy**: ORM

### Infrastructure
- **Docker & Docker Compose**: ì»¨í…Œì´ë„ˆí™”
- **Azure MySQL**: í´ë¼ìš°ë“œ ê¸°ë°˜ ë©”ì¸ ë°ì´í„°ë² ì´ìŠ¤ (SSL ì—°ê²°)
- **Redis 7.0**: ìºì‹œ & ìƒíƒœ ê´€ë¦¬
- **MinIO**: S3 í˜¸í™˜ íŒŒì¼ ìŠ¤í† ë¦¬ì§€

### Libraries
- **Pandas & NumPy**: ë°ì´í„° ì²˜ë¦¬
- **httpx**: ë¹„ë™ê¸° HTTP í´ë¼ì´ì–¸íŠ¸
- **pydantic**: ë°ì´í„° ê²€ì¦

## ğŸ›  ê°œë°œ ë„êµ¬

### Makefile ëª…ë ¹ì–´
```bash
make help        # ë„ì›€ë§
make up          # ì„œë¹„ìŠ¤ ì‹œì‘
make down        # ì„œë¹„ìŠ¤ ì¤‘ì§€
make restart     # ì¬ì‹œì‘
make logs        # ë¡œê·¸ í™•ì¸
make clean       # ë³¼ë¥¨ ì •ë¦¬
make test        # í…ŒìŠ¤íŠ¸ ì‹¤í–‰
```

## ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
ai/
â”œâ”€â”€ gateway/              # API Gateway
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ core/        # ì„¤ì •
â”‚   â”‚   â”œâ”€â”€ deps/        # ì¸ì¦ ì˜ì¡´ì„±
â”‚   â”‚   â””â”€â”€ main.py      # ë©”ì¸ ë¼ìš°íŒ…
â”‚   â””â”€â”€ requirements.txt
â”œâ”€â”€ classifier/          # ê±°ë˜ ë¶„ë¥˜ ì„œë¹„ìŠ¤
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ api/        # ì—”ë“œí¬ì¸íŠ¸
â”‚   â”‚   â”œâ”€â”€ services/   # GPT ì„œë¹„ìŠ¤
â”‚   â”‚   â””â”€â”€ models/     # ë°ì´í„° ëª¨ë¸
â”‚   â””â”€â”€ requirements.txt
â”œâ”€â”€ analysis/           # ì˜ˆì¸¡ ë¶„ì„ ì„œë¹„ìŠ¤
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ api/       # ì—”ë“œí¬ì¸íŠ¸
â”‚   â”‚   â”œâ”€â”€ services/  # Prophet ì„œë¹„ìŠ¤
â”‚   â”‚   â””â”€â”€ db/        # ë°ì´í„°ë² ì´ìŠ¤
â”‚   â””â”€â”€ requirements.txt
â”œâ”€â”€ csv-manager/        # CSV ê´€ë¦¬ ì„œë¹„ìŠ¤
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ api/       # ì—”ë“œí¬ì¸íŠ¸
â”‚   â”‚   â”œâ”€â”€ repos/     # ì €ì¥ì†Œ íŒ¨í„´
â”‚   â”‚   â””â”€â”€ models/    # ìŠ¤í‚¤ë§ˆ
â”‚   â””â”€â”€ requirements.txt
â”œâ”€â”€ docker-compose.yml  # ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜
â”œâ”€â”€ Makefile           # ë¹Œë“œ ëª…ë ¹ì–´
â”œâ”€â”€ .env.example       # í™˜ê²½ ë³€ìˆ˜ í…œí”Œë¦¿
â””â”€â”€ README.md          # ë¬¸ì„œ
```

